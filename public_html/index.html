<html>
  <head>
    <title>Letters from Whitechapel</title>
    <link rel="apple-touch-icon" href="lwc-icon.png"/>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href='http://fonts.googleapis.com/css?family=Homemade+Apple' rel='stylesheet' type='text/css'>
    <style type="text/css">
      body {
        font-family: 'Homemade Apple', cursive;
        margin:0;
      }
      
      .link {
        color: #8B2500;
        /*color: #8B0000;*/
        text-decoration: none;
        position:absolute;
      }
      
      .marker {
        position:absolute;
        width:22px;
        height:22px;
        border-radius:50px;
        opacity:0.55;
        background: #000;
        display:block;
        text-align: left;
        text-indent: 4px;
        font-size:15px;
        color:#000;
        line-height:25px;
      }

      .green {
        background:#006400;
      }

      .yellow {
        background:#EEEE00;
      }
      
      #rank-key-container {
        position:absolute;
        display:none;
        width:100%;
      }
      
      .rank-key {
        position:static;
        float:left;
        margin-right:3px;
      }
      
      .rank-1 {
        background:#76EE00;
      }
      .rank-2 {
        background:#CAFF70;
      }
      .rank-3 {
        background:#FFFF00;
      }
      .rank-4 {
        background:#CDCD00;
      }
      .rank-5 {
        background:#FFA500;
      }
      .rank-6 {
        background:#B8860B;
      }
      .rank-7 {
        background: #CD950C;
      }
      .rank-8 {
        background:#9400D3;
      }
      .rank-9 {
        background:#8B0A50;
      }
      .rank-10 {
        background:#E9967A;
      }
      .rank-11 {
        background:#FF82AB;
      }
      .rank-12 {
        background:#FF0000;
      }
      .rank-13 {
        background:#8B7765;
      }
      .rank-14 {
        background:#000000;
      }
      
      .show {
        display:block;
      }
      
      .hide {
        display:none;
      }
    </style>
  </head>
  <body>

    <img id="board" alt="" src="https://dl.dropboxusercontent.com/u/24945431/whitechapel/Letters_from_Whitechapel_003.jpg"/>
    <a id="rank-link" href="#" style="left:686px; top:30px;" class="link">Location&nbsp;rank</a> <a href="#" class="link" style="display:none; left:820px; top:30px;" id="clear-ranks">[clear]</a>
    <div id="rank-key-container" style="left:695px; top:55px;">
      <div id="rank-1-key" data-rank="1" class="marker rank-key rank-1"></div>
      <div id="rank-2-key" data-rank="2" class="marker rank-key rank-2"></div>
      <div id="rank-3-key" data-rank="3" class="marker rank-key rank-3"></div>
      <div id="rank-4-key" data-rank="4" class="marker rank-key rank-4"></div>
      <div id="rank-5-key" data-rank="5" class="marker rank-key rank-5"></div>
      <div id="rank-6-key" data-rank="6" class="marker rank-key rank-6"></div>
      <div id="rank-7-key" data-rank="7" class="marker rank-key rank-7"></div>
      <div id="rank-8-key" data-rank="8" class="marker rank-key rank-8"></div>
      <div id="rank-9-key" data-rank="9" class="marker rank-key rank-9"></div>
      <div id="rank-10-key" data-rank="10" class="marker rank-key rank-10"></div>
      <div id="rank-11-key" data-rank="11" class="marker rank-key rank-11"></div>
      <div id="rank-12-key" data-rank="12" class="marker rank-key rank-12"></div>
      <div id="rank-13-key" data-rank="13" class="marker rank-key rank-13"></div>
      <div id="rank-14-key" data-rank="14" class="marker rank-key rank-14"></div>
    </div>

    <span style="left:35px; top:85px;" class="link">Jack's&nbsp;Home:</span>
    <span class="link" style="left:45px; top:110px; line-height: 25px;">
      * <a href="#" id="home-easy" class="link">easy</a><br>
      * <a href="#" id="home-normal" class="link">normal</a><br>
      * <a href="#" id="home-hard" class="link">hard</a><br>
      * <a href="#" id="home-epic" class="link">epic</a><br>
    </span>

    <div id="location-markers">
      <div id="1" style="left:242px; top:35px;" class="marker hide"></div>
      <div id="2" style="left:394px; top:25px;" class="marker hide"></div>
      <div id="3" style="left:470px; top:24px;" class="marker hide"></div>
      <div id="4" style="left:513px; top:54px;" class="marker hide"></div>
      <div id="5" style="left:625px; top:27px;" class="marker hide"></div>
      <div id="6" style="left:192px; top:117px;" class="marker hide"></div>
      <div id="7" style="left:224px; top:106px;" class="marker hide"></div>
      <div id="8" style="left:388px; top:127px;" class="marker hide"></div>
      <div id="9" style="left:421px; top:102px;" class="marker hide"></div>
      <div id="10" style="left:462px; top:124px;" class="marker hide"></div>
      <div id="11" style="left:467px; top:79px;" class="marker hide"></div>
      <div id="12" style="left:581px; top:79px;" class="marker hide"></div>
      <div id="13" style="left:652px; top:110px;" class="marker hide"></div>
      <div id="14" style="left:698px; top:135px;" class="marker hide"></div>
      <div id="15" style="left:739px; top:128px;" class="marker hide"></div>
      <div id="16" style="left:776px; top:116px;" class="marker hide"></div>
      <div id="17" style="left:789px; top:81px;" class="marker hide"></div>
      <div id="18" style="left:895px; top:83px;" class="marker hide"></div>
      <div id="19" style="left:946px; top:119px;" class="marker hide"></div>
      <div id="20" style="left:1003px; top:114px;" class="marker hide"></div>
      <div id="21" style="left:1149px; top:79px;" class="marker hide"></div>
      <div id="22" style="left:1201px; top:137px;" class="marker hide"></div>
      <div id="23" style="left:1290px; top:94px;" class="marker hide"></div>
      <div id="24" style="left:153px; top:152px;" class="marker hide"></div>
      <div id="25" style="left:184px; top:188px;" class="marker hide"></div>
      <div id="26" style="left:260px; top:145px;" class="marker hide"></div>
      <div id="27" style="left:305px; top:194px;" class="marker hide"></div>
      <div id="28" style="left:362px; top:160px;" class="marker hide"></div>
      <div id="29" style="left:482px; top:198px;" class="marker hide"></div>
      <div id="30" style="left:530px; top:163px;" class="marker hide"></div>
      <div id="31" style="left:650px; top:192px;" class="marker hide"></div>
      <div id="32" style="left:663px; top:163px;" class="marker hide"></div>
      <div id="33" style="left:729px; top:166px;" class="marker hide"></div>
      <div id="34" style="left:759px; top:198px;" class="marker hide"></div>
      <div id="35" style="left:792px; top:182px;" class="marker hide"></div>
      <div id="36" style="left:803px; top:149px;" class="marker hide"></div>
      <div id="37" style="left:818px; top:204px;" class="marker hide"></div>
      <div id="38" style="left:829px; top:168px;" class="marker hide"></div>
      <div id="39" style="left:858px; top:178px;" class="marker hide"></div>
      <div id="40" style="left:1019px; top:168px;" class="marker hide"></div>
      <div id="41" style="left:1081px; top:147px;" class="marker hide"></div>
      <div id="42" style="left:1124px; top:165px;" class="marker hide"></div>
      <div id="43" style="left:137px; top:258px;" class="marker hide"></div>
      <div id="44" style="left:223px; top:230px;" class="marker hide"></div>
      <div id="45" style="left:288px; top:256px;" class="marker hide"></div>
      <div id="46" style="left:309px; top:221px;" class="marker hide"></div>
      <div id="47" style="left:367px; top:267px;" class="marker hide"></div>
      <div id="48" style="left:390px; top:250px;" class="marker hide"></div>
      <div id="49" style="left:513px; top:234px;" class="marker hide"></div>
      <div id="50" style="left:584px; top:214px;" class="marker hide"></div>
      <div id="51" style="left:606px; top:260px;" class="marker hide"></div>
      <div id="52" style="left:665px; top:240px;" class="marker hide"></div>
      <div id="53" style="left:706px; top:270px;" class="marker hide"></div>
      <div id="54" style="left:720px; top:221px;" class="marker hide"></div>
      <div id="55" style="left:791px; top:271px;" class="marker hide"></div>
      <div id="56" style="left:901px; top:256px;" class="marker hide"></div>
      <div id="57" style="left:974px; top:222px;" class="marker hide"></div>
      <div id="58" style="left:1115px; top:222px;" class="marker hide"></div>
      <div id="59" style="left:198px; top:302px;" class="marker hide"></div>
      <div id="60" style="left:234px; top:316px;" class="marker hide"></div>
      <div id="61" style="left:348px; top:314px;" class="marker hide"></div>
      <div id="62" style="left:423px; top:314px;" class="marker hide"></div>
      <div id="63" style="left:496px; top:305px;" class="marker hide"></div>
      <div id="64" style="left:522px; top:272px;" class="marker hide"></div>
      <div id="65" style="left:550px; top:318px;" class="marker hide"></div>
      <div id="66" style="left:576px; top:286px;" class="marker hide"></div>
      <div id="67" style="left:652px; top:290px;" class="marker hide"></div>
      <div id="68" style="left:758px; top:302px;" class="marker hide"></div>
      <div id="69" style="left:850px; top:333px;" class="marker hide"></div>
      <div id="70" style="left:902px; top:334px;" class="marker hide"></div>
      <div id="71" style="left:959px; top:326px;" class="marker hide"></div>
      <div id="72" style="left:1014px; top:316px;" class="marker hide"></div>
      <div id="73" style="left:1042px; top:278px;" class="marker hide"></div>
      <div id="74" style="left:1088px; top:302px;" class="marker hide"></div>
      <div id="75" style="left:1134px; top:316px;" class="marker hide"></div>
      <div id="76" style="left:1164px; top:292px;" class="marker hide"></div>
      <div id="77" style="left:1267px; top:279px;" class="marker hide"></div>
      <div id="78" style="left:291px; top:376px;" class="marker hide"></div>
      <div id="79" style="left:302px; top:342px;" class="marker hide"></div>
      <div id="80" style="left:373px; top:348px;" class="marker hide"></div>
      <div id="81" style="left:420px; top:390px;" class="marker hide"></div>
      <div id="82" style="left:466px; top:335px;" class="marker hide"></div>
      <div id="83" style="left:553px; top:396px;" class="marker hide"></div>
      <div id="84" style="left:616px; top:364px;" class="marker hide"></div>
      <div id="85" style="left:738px; top:395px;" class="marker hide"></div>
      <div id="86" style="left:740px; top:346px;" class="marker hide"></div>
      <div id="87" style="left:934px; top:359px;" class="marker hide"></div>
      <div id="88" style="left:994px; top:356px;" class="marker hide"></div>
      <div id="89" style="left:1056px; top:368px;" class="marker hide"></div>
      <div id="90" style="left:1092px; top:342px;" class="marker hide"></div>
      <div id="91" style="left:1100px; top:381px;" class="marker hide"></div>
      <div id="92" style="left:1146px; top:394px;" class="marker hide"></div>
      <div id="93" style="left:1188px; top:367px;" class="marker hide"></div>
      <div id="94" style="left:1227px; top:340px;" class="marker hide"></div>
      <div id="95" style="left:198px; top:406px;" class="marker hide"></div>
      <div id="96" style="left:268px; top:420px;" class="marker hide"></div>
      <div id="97" style="left:338px; top:410px;" class="marker hide"></div>
      <div id="98" style="left:484px; top:432px;" class="marker hide"></div>
      <div id="99" style="left:619px; top:432px;" class="marker hide"></div>
      <div id="100" style="left:662px; top:438px;" class="marker hide"></div>
      <div id="101" style="left:798px; top:410px;" class="marker hide"></div>
      <div id="102" style="left:830px; top:417px;" class="marker hide"></div>
      <div id="103" style="left:886px; top:414px;" class="marker hide"></div>
      <div id="104" style="left:972px; top:432px;" class="marker hide"></div>
      <div id="105" style="left:1030px; top:428px;" class="marker hide"></div>
      <div id="106" style="left:1066px; top:444px;" class="marker hide"></div>
      <div id="107" style="left:1104px; top:420px;" class="marker hide"></div>
      <div id="108" style="left:1111px; top:459px;" class="marker hide"></div>
      <div id="109" style="left:1190px; top:406px;" class="marker hide"></div>
      <div id="110" style="left:1198px; top:446px;" class="marker hide"></div>
      <div id="111" style="left:1257px; top:464px;" class="marker hide"></div>
      <div id="112" style="left:91px; top:508px;" class="marker hide"></div>
      <div id="113" style="left:145px; top:510px;" class="marker hide"></div>
      <div id="114" style="left:212px; top:489px;" class="marker hide"></div>
      <div id="115" style="left:278px; top:494px;" class="marker hide"></div>
      <div id="116" style="left:338px; top:495px;" class="marker hide"></div>
      <div id="117" style="left:384px; top:491px;" class="marker hide"></div>
      <div id="118" style="left:478px; top:520px;" class="marker hide"></div>
      <div id="119" style="left:530px; top:530px;" class="marker hide"></div>
      <div id="120" style="left:556px; top:473px;" class="marker hide"></div>
      <div id="121" style="left:588px; top:532px;" class="marker hide"></div>
      <div id="122" style="left:652px; top:491px;" class="marker hide"></div>
      <div id="123" style="left:663px; top:520px;" class="marker hide"></div>
      <div id="124" style="left:736px; top:479px;" class="marker hide"></div>
      <div id="125" style="left:752px; top:525px;" class="marker hide"></div>
      <div id="126" style="left:778px; top:484px;" class="marker hide"></div>
      <div id="127" style="left:871px; top:478px;" class="marker hide"></div>
      <div id="128" style="left:898px; top:507px;" class="marker hide"></div>
      <div id="129" style="left:942px; top:483px;" class="marker hide"></div>
      <div id="130" style="left:1008px; top:484px;" class="marker hide"></div>
      <div id="131" style="left:1076px; top:524px;" class="marker hide"></div>
      <div id="132" style="left:1158px; top:472px;" class="marker hide"></div>
      <div id="133" style="left:1163px; top:520px;" class="marker hide"></div>
      <div id="134" style="left:1209px; top:486px;" class="marker hide"></div>
      <div id="135" style="left:125px; top:548px;" class="marker hide"></div>
      <div id="136" style="left:176px; top:588px;" class="marker hide"></div>
      <div id="137" style="left:216px; top:531px;" class="marker hide"></div>
      <div id="138" style="left:224px; top:591px;" class="marker hide"></div>
      <div id="139" style="left:351px; top:590px;" class="marker hide"></div>
      <div id="140" style="left:648px; top:578px;" class="marker hide"></div>
      <div id="141" style="left:709px; top:577px;" class="marker hide"></div>
      <div id="142" style="left:844px; top:578px;" class="marker hide"></div>
      <div id="143" style="left:866px; top:538px;" class="marker hide"></div>
      <div id="144" style="left:926px; top:539px;" class="marker hide"></div>
      <div id="145" style="left:984px; top:542px;" class="marker hide"></div>
      <div id="146" style="left:1123px; top:546px;" class="marker hide"></div>
      <div id="147" style="left:1270px; top:548px;" class="marker hide"></div>
      <div id="148" style="left:106px; top:618px;" class="marker hide"></div>
      <div id="149" style="left:165px; top:628px;" class="marker hide"></div>
      <div id="150" style="left:412px; top:615px;" class="marker hide"></div>
      <div id="151" style="left:500px; top:622px;" class="marker hide"></div>
      <div id="152" style="left:555px; top:640px;" class="marker hide"></div>
      <div id="153" style="left:573px; top:602px;" class="marker hide"></div>
      <div id="154" style="left:643px; top:642px;" class="marker hide"></div>
      <div id="155" style="left:744px; top:638px;" class="marker hide"></div>
      <div id="156" style="left:810px; top:618px;" class="marker hide"></div>
      <div id="157" style="left:837px; top:658px;" class="marker hide"></div>
      <div id="158" style="left:878px; top:627px;" class="marker hide"></div>
      <div id="159" style="left:925px; top:650px;" class="marker hide"></div>
      <div id="160" style="left:985px; top:649px;" class="marker hide"></div>
      <div id="161" style="left:1022px; top:609px;" class="marker hide"></div>
      <div id="162" style="left:89px; top:678px;" class="marker hide"></div>
      <div id="163" style="left:214px; top:671px;" class="marker hide"></div>
      <div id="164" style="left:290px; top:685px;" class="marker hide"></div>
      <div id="165" style="left:470px; top:711px;" class="marker hide"></div>
      <div id="166" style="left:479px; top:672px;" class="marker hide"></div>
      <div id="167" style="left:567px; top:676px;" class="marker hide"></div>
      <div id="168" style="left:642px; top:692px;" class="marker hide"></div>
      <div id="169" style="left:680px; top:728px;" class="marker hide"></div>
      <div id="170" style="left:694px; top:676px;" class="marker hide"></div>
      <div id="171" style="left:855px; top:709px;" class="marker hide"></div>
      <div id="172" style="left:902px; top:678px;" class="marker hide"></div>
      <div id="173" style="left:954px; top:692px;" class="marker hide"></div>
      <div id="174" style="left:241px; top:744px;" class="marker hide"></div>
      <div id="175" style="left:378px; top:755px;" class="marker hide"></div>
      <div id="176" style="left:435px; top:732px;" class="marker hide"></div>
      <div id="177" style="left:512px; top:738px;" class="marker hide"></div>
      <div id="178" style="left:561px; top:761px;" class="marker hide"></div>
      <div id="179" style="left:616px; top:775px;" class="marker hide"></div>
      <div id="180" style="left:641px; top:750px;" class="marker hide"></div>
      <div id="181" style="left:710px; top:751px;" class="marker hide"></div>
      <div id="182" style="left:754px; top:771px;" class="marker hide"></div>
      <div id="183" style="left:784px; top:732px;" class="marker hide"></div>
      <div id="184" style="left:826px; top:790px;" class="marker hide"></div>
      <div id="185" style="left:884px; top:739px;" class="marker hide"></div>
      <div id="186" style="left:885px; top:783px;" class="marker hide"></div>
      <div id="187" style="left:922px; top:758px;" class="marker hide"></div>
      <div id="188" style="left:349px; top:798px;" class="marker hide"></div>
      <div id="189" style="left:484px; top:808px;" class="marker hide"></div>
      <div id="190" style="left:520px; top:838px;" class="marker hide"></div>
      <div id="191" style="left:625px; top:812px;" class="marker hide"></div>
      <div id="192" style="left:794px; top:815px;" class="marker hide"></div>
      <div id="193" style="left:859px; top:812px;" class="marker hide"></div>
      <div id="194" style="left:890px; top:837px;" class="marker hide"></div>
      <div id="195" style="left:957px; top:831px;" class="marker hide"></div>
    </div>
  
    
    
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="lwc.js" type="text/javascript"></script>
    <script type="text/javascript">
    $(function() {
      // rank
      $("#rank-link").click(showRanks);
      $(".rank-key").click(showSelectedRankOnly);
      $("#clear-ranks").click(clearRanks);
      
      // random home space
      $("#home-easy").click(pickEasyNode);
      $("#home-normal").click(pickNormalNode);
      $("#home-hard").click(pickHardNode);
      $("#home-epic").click(pickEpicNode);
    });
    
    function pickEasyNode() {
      pickNodes(function(i, node) {
        return node.numberOfAdjacentNodes() >= 11;
      });
    }
    
    function pickNormalNode() {
      pickNodes(function(i, node) {
        var adjacentNodes = node.numberOfAdjacentNodes();
        return adjacentNodes >= 8 && adjacentNodes < 11;
      });
    }
    
    function pickHardNode() {
      pickNodes(function(i, node) {
        var adjacentNodes = node.numberOfAdjacentNodes();
        return adjacentNodes >= 5 && adjacentNodes < 8;
      });
    }
    
    function pickEpicNode() {
      pickNodes(function(i, node) {
        var adjacentNodes = node.numberOfAdjacentNodes();
        return adjacentNodes < 5;
      });
    }
    
    function pickNodes(filterFn) {
      var allNodes = getSortedNodes();
      var filteredNodes = $(allNodes).filter(filterFn);
      randomPick(filteredNodes);
    }
    
    function randomPick(nodes) {
      var min = 0;
      var max = nodes.length - 1;
      var iterations = 20;
      for (var i = 0; i < iterations; i++) {
        window.setTimeout(function() { 
          var randomIndex = getRandomInt(min, max);
          var node = nodes[randomIndex];
          showPossibleSpot(node); 
        }, 250*i);
      }
      
      window.setTimeout(function() { 
        var randomIndex = getRandomInt(min, max);
        var node = nodes[randomIndex];
        showPossibleSpot(node, true); 
      }, 250*iterations);
      
    }
    
    function showPossibleSpot(node, addBigVisualEffect) {
      //console.log("showing ", node);
      hide($("#location-markers .marker"));
      turnOnNodes([node]);
      if (addBigVisualEffect) {
        var $nodeEl = $("#"+node.id);
        $nodeEl.css({
          "width":"200px", 
          "height":"200px", 
          "border-radius":"100px", 
          "margin-left": "-90px", 
          "margin-top":"-90px" 
        });
        $nodeEl.animate({
          "width": "22px",
          "height": "22px",
          "border-radius": "50px",
          "margin":0
        }, 2000 );
      }
    }
    
    function getRandomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }
    
    function showRanks() {
      $("#rank-key-container").show();
      $("#clear-ranks").show();
      var nodes = getSortedNodes();
      turnOnNodes(nodes);
      addFrequencyNumbersToRankKeys();
    }
    
    function clearRanks() {
      clearAllMarkers();
      $("#rank-key-container").hide();
      $("#clear-ranks").hide();
    }
    
    function turnOnNodes(nodes) {
      $.each(nodes, function(i, node) {
        var $nodeEl = $("#"+node.id);
        var rank = getRank(node);
        show($nodeEl.addClass("rank-" + rank));
      });
    }
    
    function addFrequencyNumbersToRankKeys() {
      $("#rank-1-key").html($("#location-markers .rank-1").length);
      $("#rank-2-key").html($("#location-markers .rank-2").length);
      $("#rank-3-key").html($("#location-markers .rank-3").length);
      $("#rank-4-key").html($("#location-markers .rank-4").length);
      $("#rank-5-key").html($("#location-markers .rank-5").length);
      $("#rank-6-key").html($("#location-markers .rank-6").length);
      $("#rank-7-key").html($("#location-markers .rank-7").length);
      $("#rank-8-key").html($("#location-markers .rank-8").length);
      $("#rank-9-key").html($("#location-markers .rank-9").length);
      $("#rank-10-key").html($("#location-markers .rank-10").length);
      $("#rank-11-key").html($("#location-markers .rank-11").length);
      $("#rank-12-key").html($("#location-markers .rank-12").length);
      $("#rank-13-key").html($("#location-markers .rank-13").length);
      $("#rank-14-key").html($("#location-markers .rank-14").length).css("color", "#fff");
    }
    
    function showSelectedRankOnly(e) {
      var $target = $(e.target);
      var targetRank = parseInt($target.data("rank"));
      clearAllMarkers();
      var nodes = getSortedNodes();
      $.each(nodes, function(i, node) {
        var rank = getRank(node);
        if (rank === targetRank) {
          show($("#"+node.id).addClass("rank-" + rank));
        }
      });
    }
    
    function clearAllMarkers() {
      hide($("#location-markers .marker"));
    }
    
    function getRank(node) {
      return 16 - node.numberOfAdjacentNodes();
    }
    
    function hide($el) {
      $el.removeClass("show").addClass("hide");
      return $el;
    }
    
    function show($el) {
      $el.removeClass("hide").addClass("show");
      return $el;
    }
  </script>
  </body>
</html>